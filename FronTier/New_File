This is a front tracking algorithm.
